<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Classcodes • coder</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Classcodes">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">coder</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/coder.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/classcodes.html">Classcodes</a></li>
    <li><a class="dropdown-item" href="../articles/ex_data.html">Example data</a></li>
    <li><a class="dropdown-item" href="../articles/Interpret_regular_expressions.html">Interpret regular expressions</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ropensci/coder/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Classcodes</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/coder/blob/HEAD/vignettes/classcodes.Rmd" class="external-link"><code>vignettes/classcodes.Rmd</code></a></small>
      <div class="d-none name"><code>classcodes.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://docs.ropensci.org/coder/">coder</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="motivating-example">Motivating example<a class="anchor" aria-label="anchor" href="#motivating-example"></a>
</h2>
<p>Let’s consider some example data (<code>ex_peopple</code> and
<code>ex_icd10</code>) from <code><a href="../articles/ex_data.html">vignette("ex_data")</a></code>.</p>
<p>Let’s categorize those patients by their Charlson comorbidity:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/categorize.html">categorize</a></span><span class="op">(</span><span class="va">ex_people</span>, codedata <span class="op">=</span> <span class="va">ex_icd10</span>, cc <span class="op">=</span> <span class="va">charlson</span>, id <span class="op">=</span> <span class="st">"name"</span>, code <span class="op">=</span> <span class="st">"icd10"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classification based on: icd10</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 100 × 25</span></span></span>
<span><span class="co">#&gt;    name              surgery    myocardial.infarction congestive.heart.failure</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Chen, Trevor      2025-04-21 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Graves, Acineth   2025-01-11 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Trujillo, Yanelly 2024-12-29 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Simpson, Kenneth  2025-04-02 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Chin, Nelson      2025-03-16 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Le, Christina     2024-10-18 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Kang, Xuan        2025-01-20 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Shuemaker, Lauren 2024-10-19 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Boucher, Teresa   2025-03-27 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Le, Soraiya       2025-03-01 FALSE                 FALSE                   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 90 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 21 more variables: peripheral.vascular.disease &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   cerebrovascular.disease &lt;lgl&gt;, dementia &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   chronic.pulmonary.disease &lt;lgl&gt;, rheumatic.disease &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   peptic.ulcer.disease &lt;lgl&gt;, mild.liver.disease &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   diabetes.without.complication &lt;lgl&gt;, hemiplegia.or.paraplegia &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   renal.disease &lt;lgl&gt;, diabetes.complication &lt;lgl&gt;, malignancy &lt;lgl&gt;, …</span></span></span></code></pre></div>
<p>Here, <code>charlson</code> (as supplied by the <code>cc</code>
argument) is a “classcodes” object containing a classification scheme.
This is the specification of how to match <code>ex_icd10$icd10</code> to
each condition recognized by the Charlson comorbidity classification. It
is based on regular expressions (see <code><a href="https://rdrr.io/r/base/regex.html" class="external-link">?regex</a></code>).</p>
</div>
<div class="section level2">
<h2 id="default-classcodes">Default classcodes<a class="anchor" aria-label="anchor" href="#default-classcodes"></a>
</h2>
<p>There are 7 default “classcodes” objects in the package
(<code>classcodes</code> column below). Each of them might have several
versions of regular expressions (column <code>regex</code>) and weighted
indices (column <code>indices</code>):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/all_classcodes.html">all_classcodes</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 7 × 3</span></span></span>
<span><span class="co">#&gt;   classcodes    regex                                                    indices</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> charlson      icd10, icd9cm_deyo, icd9cm_enhanced, icd10_rcs, icd10_s… <span style="color: #949494;">"</span>charl…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> cps           icd10                                                    <span style="color: #949494;">"</span>only_…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> elixhauser    icd10, icd10_short, icd9cm, icd9cm_ahrqweb, icd9cm_enha… <span style="color: #949494;">"</span>sum_a…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> hip_ae        icd10, kva, icd10_fracture                               <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> hip_ae_hailer icd10, kva                                               <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> knee_ae       icd10, kva                                               <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> rxriskv       atc_pratt, atc_caughey, atc_garland                      <span style="color: #949494;">"</span>pratt…</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="classcodes-object">classcodes object<a class="anchor" aria-label="anchor" href="#classcodes-object"></a>
</h2>
<p>Each of those classcodes objects are documented (see for example
<code><a href="../reference/charlson.html">?charlson</a></code>). Those objects are basically tibbles (data
frames) with some additional attributes:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">charlson</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Classcodes object</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Regular expressions:</span></span>
<span><span class="co">#&gt;    icd10, icd9cm_deyo, icd9cm_enhanced, icd10_rcs, icd10_swe, icd8_brusselaers, icd9_brusselaers </span></span>
<span><span class="co">#&gt; Indices:</span></span>
<span><span class="co">#&gt;    charlson, deyo_ramano, dhoore, ghali, quan_original, quan_updated   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 17 × 15</span></span></span>
<span><span class="co">#&gt;    group       description icd10 icd9cm_deyo icd9cm_enhanced icd10_rcs icd10_swe</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> myocardial… Acute myoc… I2([… 41[02]      41[02]          <span style="color: #949494;">"</span>I2([1-3… I2([12]|…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> congestive… Heart fail… I(09… 428         39891|4(0(2([0… <span style="color: #949494;">"</span>I(1[13]… I((1(1[1…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> peripheral… Peripheral… I7([… 44(39|1)|7… 0930|4(373|4[0… <span style="color: #949494;">"</span>(I7([0-… (I7([01]…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> cerebrovas… Cerebrovas… G4[5… 43[0-8]     36234|43[0-8]   <span style="color: #949494;">"</span>G4[56]|… G45|I6[0…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> dementia    Senile and… F0([… 290         29(0|41)|3312   <span style="color: #949494;">"</span>A810|F0… F0([0-3]…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> chronic pu… Chronic ob… (I27… 490|50([0-… 4(16[89]|9)|50… <span style="color: #949494;">"</span>(I2[67]… J(4[1-7]…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> rheumatic … Systemic l… M(0[… 7(1(0[014]… 4465|7(1(0[0-4… <span style="color: #949494;">"</span>M(0[569… M(0([568…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> peptic ulc… Gastric, d… K2[5… 53[1-4]     53[1-4]          <span style="color: #BB0000;">NA</span>       K2[5-8]  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> mild liver… Alcoholic … B18|… 571[24-6]   070([23]{2}|[4…  <span style="color: #BB0000;">NA</span>       B1[5-9]|…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> diabetes w… Diabetes w… E1[0… 250[0-37]   250[0-389]       <span style="color: #BB0000;">NA</span>       E1([0-4]…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> hemiplegia… Paraplegia… G(04… 34(41|2)    3(341|4([23]|4… <span style="color: #949494;">"</span>G(114|8… G(114|8(…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> renal dise… Chronic gl… I1(2… 58([2568]|… 40(3([019]1)|4… <span style="color: #949494;">"</span>I1[23]|… I1(20|31…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> diabetes c… Diabetes w… E1[0… 250[4-6]    250[4-7]        <span style="color: #949494;">"</span>E1[0-4]<span style="color: #949494;">"</span> E1(0[2-5…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> malignancy  Malignant … C([0… (1([4-68]|… 1([4-68]|7[0-2… <span style="color: #949494;">"</span>C([01]|… C([0-36]…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> moderate o… Hepatic co… I(8(… 456[01]|57… 456[0-2]|572[2… <span style="color: #949494;">"</span>B18|I(8… I((85[09…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> metastatic… Secondary … C(7[… 19([6-8]|9… 19[6-9]         <span style="color: #949494;">"</span>C(7[7-9… C(7[789]…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> AIDS/HIV    HIV infect… B2[0… 04[2-4]     04[2-4]         <span style="color: #949494;">"</span>B2[0-4]<span style="color: #949494;">"</span> B2[0-4]|…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 8 more variables: icd8_brusselaers &lt;chr&gt;, icd9_brusselaers &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   charlson &lt;dbl&gt;, deyo_ramano &lt;dbl&gt;, dhoore &lt;dbl&gt;, ghali &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   quan_original &lt;dbl&gt;, quan_updated &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Columns have pre-specified names and/or content:</p>
<ul>
<li>
<code>group</code>: short descriptive names of all groups to
classify by (i.e. medical conditions/comorbidities in the Charlson
case)</li>
<li>
<code>description:</code> (optional) details describing each
group</li>
<li>regular expressions identifying each group (see
<code><a href="../articles/Interpret_regular_expressions.html">vignette("Interpret_regular_expressions")</a></code> for details and
<code><a href="../reference/charlson.html">?charlson</a></code> for concrete examples). Multiple versions might
be used if combined with different code sets (i.e. ICD-9 versus ICD-10)
or as suggested by different sources/authors. (Column names are
arbitrary but identified by <code>attr(., "regexprs")</code> and
specified by argument <code>regex</code> in
<code><a href="../reference/classcodes.html">as.classcodes()</a></code>).</li>
<li>numeric vectors used as weights when calculating index sums based on
all (or a subset of) individual groups. (Column names are arbitrary but
identified by <code>attr(., "indices")</code> and specified by argument
<code>indices</code> in <code><a href="../reference/classcodes.html">as.classcodes()</a></code>.)</li>
<li>
<code>condition</code>: (optional) conditional classification (not
used with <code>charlson</code> but see example below).</li>
</ul>
<p>In the example above, we did not specify which version of the regular
expressions to use. We see from the printed output above (or by
<code>attr(charlson, "regexprs")</code>), that the first regular
expression is “icd10”. This will be used by default. We have ICD-10
codes recorded in our code data set (<code>ex_icd10$icd10</code>). We
might therefore use either “icd10” or the alternative “icd10_rcs”. Other
versions might be relevant if the medical data is coded by other codes
(such as earlier versions of ICD). We will show below how to alter this
setting in practice.</p>
</div>
<div class="section level2">
<h2 id="hierarchy">Hierarchy<a class="anchor" aria-label="anchor" href="#hierarchy"></a>
</h2>
<p>Some classcodes objects have an additional class attribute
“hierarchy”, controlling hierarchical groups where only one of possibly
several groups should be used in weighted index sums. The classcodes
object for the Elixhauser comorbidity classification has this
property:<br></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">elixhauser</span>, n <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="co"># preview 0 rows but present the attributes</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Classcodes object</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Regular expressions:</span></span>
<span><span class="co">#&gt;    icd10, icd10_short, icd9cm, icd9cm_ahrqweb, icd9cm_enhanced </span></span>
<span><span class="co">#&gt; Indices:</span></span>
<span><span class="co">#&gt;    sum_all, sum_all_ahrq, walraven, sid29, sid30, ahrq_mort, ahrq_readm </span></span>
<span><span class="co">#&gt; Hierarchy:</span></span>
<span><span class="co">#&gt;    c("metastatic cancer", "solid tumor"),</span></span>
<span><span class="co">#&gt;    c("diabetes uncomplicated", "diabetes complicated")</span></span></code></pre></div>
<p>This means that patients who have both metastatic cancer and solid
tumors should be recognized as such if classified. If such patient are
assigned an aggregated index score, however, only the largest score is
used (in this case for a metastatic cancer as superior to a solid
tumor). The same is true for patients diagnosed with both uncomplicated
and complicated diabetes.</p>
<p>Consider a patient Alice with some diagnoses:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Alice"</span><span class="op">)</span></span>
<span><span class="va">diags</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C01"</span>, <span class="st">"C801"</span>, <span class="st">"E1010"</span>, <span class="st">"E1021"</span><span class="op">)</span></span>
<span><span class="fu">decoder</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/decoder/man/decode.html" class="external-link">decode</a></span><span class="op">(</span><span class="va">diags</span>, <span class="fu">decoder</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/decoder/man/icd10cm.html" class="external-link">icd10cm</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Malignant neoplasm of base of tongue"                   </span></span>
<span><span class="co">#&gt; [2] "Malignant (primary) neoplasm, unspecified"              </span></span>
<span><span class="co">#&gt; [3] "Type 1 diabetes mellitus with ketoacidosis without coma"</span></span>
<span><span class="co">#&gt; [4] "Type 1 diabetes mellitus with diabetic nephropathy"</span></span></code></pre></div>
<p>According to Elixhauser, poor Alice has both a solid tumor and a
metastatic cancer, as well as diabetes both with and without
complications. The (unweighted) index “sum_all”, however will not equal
4 but 2, since metastatic cancer and diabetes with complications subsume
solid tumors and diabetes without complications.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">icd10</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>id <span class="op">=</span> <span class="st">"Alice"</span>, icd10 <span class="op">=</span> <span class="va">diags</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/categorize.html">categorize</a></span><span class="op">(</span><span class="va">pat</span>, codedata <span class="op">=</span> <span class="va">icd10</span>, cc <span class="op">=</span> <span class="va">elixhauser</span>, </span>
<span>                id <span class="op">=</span> <span class="st">"id"</span>, code <span class="op">=</span> <span class="st">"icd10"</span>, index <span class="op">=</span> <span class="st">"sum_all"</span>, check.names <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classification based on: icd10</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="co">#&gt;                                [,1]   </span></span>
<span><span class="co">#&gt; id                             "Alice"</span></span>
<span><span class="co">#&gt; congestive heart failure       "FALSE"</span></span>
<span><span class="co">#&gt; cardiac arrhythmias            "FALSE"</span></span>
<span><span class="co">#&gt; valvular disease               "FALSE"</span></span>
<span><span class="co">#&gt; pulmonary circulation disorder "FALSE"</span></span>
<span><span class="co">#&gt; peripheral vascular disorder   "FALSE"</span></span>
<span><span class="co">#&gt; hypertension uncomplicated     "FALSE"</span></span>
<span><span class="co">#&gt; hypertension complicated       "FALSE"</span></span>
<span><span class="co">#&gt; paralysis                      "FALSE"</span></span>
<span><span class="co">#&gt; other neurological disorders   "FALSE"</span></span>
<span><span class="co">#&gt; chronic pulmonary disease      "FALSE"</span></span>
<span><span class="co">#&gt; diabetes uncomplicated         "TRUE" </span></span>
<span><span class="co">#&gt; diabetes complicated           "TRUE" </span></span>
<span><span class="co">#&gt; hypothyroidism                 "FALSE"</span></span>
<span><span class="co">#&gt; renal failure                  "FALSE"</span></span>
<span><span class="co">#&gt; liver disease                  "FALSE"</span></span>
<span><span class="co">#&gt; peptic ulcer disease           "FALSE"</span></span>
<span><span class="co">#&gt; AIDS/HIV                       "FALSE"</span></span>
<span><span class="co">#&gt; lymphoma                       "FALSE"</span></span>
<span><span class="co">#&gt; metastatic cancer              "TRUE" </span></span>
<span><span class="co">#&gt; solid tumor                    "TRUE" </span></span>
<span><span class="co">#&gt; rheumatoid arthritis           "FALSE"</span></span>
<span><span class="co">#&gt; coagulopathy                   "FALSE"</span></span>
<span><span class="co">#&gt; obesity                        "FALSE"</span></span>
<span><span class="co">#&gt; weight loss                    "FALSE"</span></span>
<span><span class="co">#&gt; fluid electrolyte disorders    "FALSE"</span></span>
<span><span class="co">#&gt; blood loss anemia              "FALSE"</span></span>
<span><span class="co">#&gt; deficiency anemia              "FALSE"</span></span>
<span><span class="co">#&gt; alcohol abuse                  "FALSE"</span></span>
<span><span class="co">#&gt; drug abuse                     "FALSE"</span></span>
<span><span class="co">#&gt; psychoses                      "FALSE"</span></span>
<span><span class="co">#&gt; depression                     "FALSE"</span></span>
<span><span class="co">#&gt; sum_all                        "2"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conditions">Conditions<a class="anchor" aria-label="anchor" href="#conditions"></a>
</h2>
<p>Consider Alice once more. Suppose she got a THA and had some surgical
procedure codes recorded at hospital visits either before, during or
after her index surgery. Those codes are recorded by the Nomesco
classification of surgical procedures (also known as KVA codes in
Swedish). Here, “post_op” indicates whether the code was recorded after
surgery or not. This information is not always accessible by pure date
stamps (if so, the approach illustrated in
<code><a href="../articles/coder.html">vignette("coder")</a></code> could be used instead).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">nomesco</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span>
<span>    id      <span class="op">=</span> <span class="st">"Alice"</span>,</span>
<span>    kva     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AA01"</span>, <span class="st">"NFC01"</span><span class="op">)</span>,</span>
<span>    post_op <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>Thus, the “post_op” column is a Boolean/logical vector with a name
recognized from the “condition” column in <code>hip_ae</code>, a
classcodes object used to identify adverse events after THA (the use of
<code><a href="../reference/set_classcodes.html">set_classcodes()</a></code> is further explained below and is used
here since <code>hip_ae</code> includes codes for both ICD and
NOMESCO/KVA).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/set_classcodes.html">set_classcodes</a></span><span class="op">(</span><span class="va">hip_ae</span>, regex <span class="op">=</span> <span class="st">"kva"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Classcodes object</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Regular expressions:</span></span>
<span><span class="co">#&gt;    kva </span></span>
<span><span class="co">#&gt; Indices:</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   group kva                                                            condition</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> KVA   ^(NF([CF-HJ-MS-TW]|A(02|1[12]|2[0-2])|Q09|U[013489]9)|QD(A10|… post_op</span></span></code></pre></div>
<p>A code from <code>nomesco$kva</code> will only be recognized as an
adverse events if 1) the code is matched by the relevant regular
expression, and 2) the extra condition (from
<code>nomesco$post_op</code>) is <code>TRUE.</code></p>
<p>We need to specify that codes are based on regular expressions
matching NOMESCO codes. We do this by the <code>regex</code> argument
passed to <code><a href="../reference/set_classcodes.html">set_classcodes()</a></code> by the <code>cc_args</code>
argument.</p>
<p>In the data set (<code>nomesco</code>), “AA01” was recorded after
surgery but does not indicate a potential adverse event. “NFC01” is a
potential adverse event but was recorded already before surgery.
Therefore, no adverse event will be recognized in this case.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/categorize.html">categorize</a></span><span class="op">(</span><span class="va">pat</span>, codedata <span class="op">=</span> <span class="va">nomesco</span>, cc <span class="op">=</span> <span class="va">hip_ae</span>, id <span class="op">=</span> <span class="st">"id"</span>, code <span class="op">=</span> <span class="st">"kva"</span>,</span>
<span>           cc_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>regex <span class="op">=</span> <span class="st">"kva"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; index calculated as number of relevant categories</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;   id    KVA   index</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Alice FALSE     0</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use-classcodes-objects">Use classcodes objects<a class="anchor" aria-label="anchor" href="#use-classcodes-objects"></a>
</h2>
<p>Most functions do not use the classcodes object themselves, but a
modified version passed through <code><a href="../reference/set_classcodes.html">set_classcodes()</a></code>. This
function can be called directly but is more often invoked by arguments
passed by the <code>cc_args</code> argument used in other functions (as
in the example above).</p>
<div class="section level3">
<h3 id="explicit-use-of-set_classcodes">Explicit use of <code>set_classcodes()</code><a class="anchor" aria-label="anchor" href="#explicit-use-of-set_classcodes"></a>
</h3>
<p>We might use <code><a href="../reference/set_classcodes.html">set_classcodes()</a></code> to prepare a
classification scheme according to the Charlson comorbidity index based
on ICD-8 <span class="citation">(Brusselaers and Lagergren 2017)</span>.
Assume that such codes might be found in character strings with leading
prefixes or in the middle of a more verbatim description. This is
controlled by setting the argument <code>start = FALSE</code>, meaning
that the identified ICD-8 codes do not need to appear in the beginning
of the character string. We might assume, however, that there is no more
information after the code (as specified by <code>stop = TRUE</code>).
We can also use some more specific and unique group names as specified
by <code>tech_names</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">charlson_icd8</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/set_classcodes.html">set_classcodes</a></span><span class="op">(</span></span>
<span>    <span class="st">"charlson"</span>,</span>
<span>    regex      <span class="op">=</span> <span class="st">"icd8_brusselaers"</span>, <span class="co"># Version based on ICD-8</span></span>
<span>    start      <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Codes do not have to occur in the beginning of a vector</span></span>
<span>    stop       <span class="op">=</span> <span class="cn">TRUE</span>,  <span class="co"># Code vector must end with the specified codes</span></span>
<span>    tech_names <span class="op">=</span> <span class="cn">TRUE</span>   <span class="co"># Use long but unique and descriptive variable names</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>The resulting object has only one version of regular expressions
(<code>icd8_brusselaers</code> as specified). Each regular expression is
suffixed with <code>$</code> (due to <code>stop = TRUE</code>). Group
names might seem cumbersome but this will help to distinguish column
names added by <code><a href="../reference/categorize.html">categorize()</a></code> if this function is run
repeatedly with different classcodes (i.e. if we calculate both Charlson
and Elixhauser indices for the same patients). The original
<code>charlson</code> object had 17 rows, but <code>charlson_icd8</code>
has only 13, since not all groups are used in this version.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">charlson_icd8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Classcodes object</span></span>
<span><span class="co">#&gt;  </span></span>
<span><span class="co">#&gt; Regular expressions:</span></span>
<span><span class="co">#&gt;    icd8_brusselaers </span></span>
<span><span class="co">#&gt; Indices:</span></span>
<span><span class="co">#&gt;    charlson, deyo_ramano, dhoore, ghali, quan_original, quan_updated   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 13 × 9</span></span></span>
<span><span class="co">#&gt;    group          description icd8_brusselaers charlson deyo_ramano dhoore ghali</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> charlson_icd8… Acute myoc… (41[0-2])$              1           1      1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> charlson_icd8… Heart fail… (4270|428)$             1           1      1     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> charlson_icd8… Peripheral… (44[0-5])$              1           1      1     2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> charlson_icd8… Cerebrovas… (43[0-8])$              1           1      1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> charlson_icd8… Senile and… (290[01])$              1           1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> charlson_icd8… Chronic ob… (49[0-3]|51[5-8…        1           1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> charlson_icd8… Systemic l… (7(1[0-2]|34))$         1           1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> charlson_icd8… Paraplegia… (344)$                  2           1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> charlson_icd8… Chronic gl… (40[34]|58[0-3]…        2           1      1     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> charlson_icd8… Diabetes w… (250)$                  2           1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> charlson_icd8… Malignant … (1([4-68][0-9]|…        2           1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> charlson_icd8… Hepatic co… (070|4560|51[1-…        3           1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> charlson_icd8… Secondary … (19[6-9])$              6           1      1     0</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: quan_original &lt;dbl&gt;, quan_updated &lt;dbl&gt;</span></span></span></code></pre></div>
<p>Note that all index columns remain in the tibble. It is thus possible
to combine any categorization with any index, although some combinations
might be preferred (such as <code>regex_icd9cm_deyo</code> combined with
<code>index_deyo_ramano</code>).</p>
<p>We can now use <code>charlson_icd8</code> for classification:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span><span class="fl">410</span>, <span class="va">charlson_icd8</span><span class="op">)</span></span>
<span><span class="co">#&gt; Classification based on: icd8_brusselaers</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The printed data is of class: classified, matrix.</span></span>
<span><span class="co">#&gt; It has 1 row(s).</span></span>
<span><span class="co">#&gt; It is here previewed as a tibble</span></span>
<span><span class="co">#&gt; Use `print(x, n = NULL)` to print as is (or use `n` to specify the number of rows to preview)!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 13</span></span></span>
<span><span class="co">#&gt;   charlson_icd8_brusselaers_myoc…¹ charlson_icd8_brusse…² charlson_icd8_brusse…³</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TRUE                             FALSE                  FALSE                 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated names: ¹​charlson_icd8_brusselaers_myocardial_infarction,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ²​charlson_icd8_brusselaers_congestive_heart_failure,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ³​charlson_icd8_brusselaers_peripheral_vascular_disease</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10 more variables: charlson_icd8_brusselaers_cerebrovascular_disease &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   charlson_icd8_brusselaers_dementia &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   charlson_icd8_brusselaers_chronic_pulmonary_disease &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   charlson_icd8_brusselaers_rheumatic_disease &lt;lgl&gt;, …</span></span></span></code></pre></div>
<p>The ICD-8 code <code>410</code>is recognized as (only) myocardial
infarction.</p>
</div>
<div class="section level3">
<h3 id="implicit-use-of-set_classcodes">Implicit use of <code>set_classcodes()</code><a class="anchor" aria-label="anchor" href="#implicit-use-of-set_classcodes"></a>
</h3>
<p>Instead of pre-specifying the <code>charlson_icd8</code>, a similar
result is achieved by:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/classify.html">classify</a></span><span class="op">(</span></span>
<span>  <span class="fl">410</span>,</span>
<span>  <span class="st">"charlson"</span>,</span>
<span>  cc_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    regex      <span class="op">=</span> <span class="st">"icd8_brusselaers"</span>, </span>
<span>    start      <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>    stop       <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    tech_names <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The printed data is of class: classified, matrix.</span></span>
<span><span class="co">#&gt; It has 1 row(s).</span></span>
<span><span class="co">#&gt; It is here previewed as a tibble</span></span>
<span><span class="co">#&gt; Use `print(x, n = NULL)` to print as is (or use `n` to specify the number of rows to preview)!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 13</span></span></span>
<span><span class="co">#&gt;   charlson_icd8_brusselaers_myoc…¹ charlson_icd8_brusse…² charlson_icd8_brusse…³</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                            <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                  <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>                 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> TRUE                             FALSE                  FALSE                 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ abbreviated names: ¹​charlson_icd8_brusselaers_myocardial_infarction,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ²​charlson_icd8_brusselaers_congestive_heart_failure,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ³​charlson_icd8_brusselaers_peripheral_vascular_disease</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 10 more variables: charlson_icd8_brusselaers_cerebrovascular_disease &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   charlson_icd8_brusselaers_dementia &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   charlson_icd8_brusselaers_chronic_pulmonary_disease &lt;lgl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   charlson_icd8_brusselaers_rheumatic_disease &lt;lgl&gt;, …</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="bibliography">Bibliography<a class="anchor" aria-label="anchor" href="#bibliography"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Brusselaers2017" class="csl-entry">
Brusselaers, Nele, and Jesper Lagergren. 2017. <span>“The Charlson
Comorbidity Index in Registry-Based Research.”</span> <em>Methods of
Information in Medicine</em> 56 (05): 401–6. <a href="https://doi.org/10.3414/ME17-01-0051" class="external-link">https://doi.org/10.3414/ME17-01-0051</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/ropensci" class="external-link">Erik Bulow</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
